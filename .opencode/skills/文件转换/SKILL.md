---
name: everything to Markdown
description: ä½¿ç”¨ markitdown å°†å„ç§æ–‡ä»¶æ ¼å¼è½¬æ¢ä¸º Markdown
---

## Profile

- language: ä¸­æ–‡
- description: ä½¿ç”¨ Python å’Œ markitdown åº“å°†å„ç§æ–‡æ¡£æ ¼å¼ï¼ˆPDFã€Office æ–‡æ¡£ã€å›¾ç‰‡ã€éŸ³é¢‘ç­‰ï¼‰è½¬æ¢ä¸º Markdown æ ¼å¼
- background: åŸºäº Microsoft çš„ markitdown å¼€æºåº“ï¼Œå¯ä»¥å°†å¤šç§æ–‡ä»¶æ ¼å¼è½¬æ¢ä¸ºç»“æ„åŒ–çš„ Markdown æ–‡æœ¬
- expertise: PDFã€PowerPointã€Wordã€Excelã€å›¾ç‰‡ï¼ˆOCRï¼‰ã€éŸ³é¢‘ï¼ˆè½¬å½•ï¼‰ã€HTMLã€CSVã€JSONã€XMLã€ZIPã€YouTubeã€EPUB ç­‰æ ¼å¼è½¬æ¢

## Skills

### ğŸ“„ æ–‡æ¡£è½¬æ¢èƒ½åŠ›

- **PDF è½¬æ¢**: å°† PDF æ–‡æ¡£è½¬æ¢ä¸º Markdownï¼Œä¿ç•™æ–‡æ¡£ç»“æ„
- **Office æ–‡æ¡£**: æ”¯æŒ PowerPointï¼ˆ.pptxï¼‰ã€Wordï¼ˆ.docxï¼‰ã€Excelï¼ˆ.xlsx/.xlsï¼‰è½¬æ¢
- **å›¾ç‰‡å¤„ç†**: æå– EXIF å…ƒæ•°æ®å¹¶è¿›è¡Œ OCR æ–‡å­—è¯†åˆ«
- **éŸ³é¢‘è½¬å½•**: æå–éŸ³é¢‘å…ƒæ•°æ®å¹¶è¿›è¡Œè¯­éŸ³è½¬å½•ï¼ˆæ”¯æŒ .wavã€.mp3ï¼‰
- **ç½‘é¡µè½¬æ¢**: å°† HTML è½¬æ¢ä¸º Markdown
- **ç»“æ„åŒ–æ•°æ®**: è½¬æ¢ CSVã€JSONã€XML ç­‰æ ¼å¼
- **å‹ç¼©æ–‡ä»¶**: å¤„ç† ZIP æ–‡ä»¶ä¸­çš„å†…å®¹
- **ç”µå­ä¹¦**: æ”¯æŒ EPUB æ ¼å¼è½¬æ¢

### ğŸ”§ å¯ç”¨å·¥å…·

æœ¬ skill æä¾›ä»¥ä¸‹ Python è„šæœ¬ï¼š

1. `convert_file.py` - è½¬æ¢å•ä¸ªæ–‡ä»¶ä¸º Markdown
2. `batch_convert.py` - æ‰¹é‡è½¬æ¢å¤šä¸ªæ–‡ä»¶
3. `convert_with_llm.py` - ä½¿ç”¨ LLM å¢å¼ºå›¾ç‰‡æè¿°ï¼ˆå¯é€‰ï¼‰

## Rules

1. **ç¯å¢ƒè¦æ±‚**:
   - å¿…é¡»åœ¨æ¯æ¬¡ä½¿ç”¨å‰è¿è¡Œ `setup.sh` ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»ºå¹¶æ¿€æ´»
   - æ‰€æœ‰ Python è„šæœ¬å¿…é¡»åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œ
   - ä¾èµ–é¡¹åœ¨ `requirements.txt` ä¸­å®šä¹‰
   - éŸ³é¢‘è½¬å½•åŠŸèƒ½éœ€è¦ç³»ç»Ÿå®‰è£… `ffmpeg`ï¼ˆå¯é€‰ï¼ŒmacOS: `brew install ffmpeg`ï¼‰

2. **æ”¯æŒçš„æ–‡ä»¶æ ¼å¼**:
   - æ–‡æ¡£: PDF, DOCX, PPTX, XLSX, XLS
   - å›¾ç‰‡: JPG, PNG, GIF ç­‰ï¼ˆæ”¯æŒ OCRï¼‰
   - éŸ³é¢‘: WAV, MP3ï¼ˆæ”¯æŒè½¬å½•ï¼‰
   - ç½‘é¡µ: HTML
   - ç»“æ„åŒ–: CSV, JSON, XML
   - å…¶ä»–: ZIP, EPUB

3. **å¯é€‰åŠŸèƒ½**:
   - Azure Document Intelligence: ä½¿ç”¨ Azure æœåŠ¡è¿›è¡Œé«˜è´¨é‡æ–‡æ¡£è½¬æ¢
   - LLM å›¾ç‰‡æè¿°: ä½¿ç”¨ OpenAI ç­‰ LLM ä¸ºå›¾ç‰‡ç”Ÿæˆè¯¦ç»†æè¿°
   - æ’ä»¶ç³»ç»Ÿ: æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶æ‰©å±•åŠŸèƒ½

4. **è¾“å‡ºè¯´æ˜**:
   - é»˜è®¤è¾“å‡ºåˆ°ç»ˆç«¯
   - å¯æŒ‡å®šè¾“å‡ºæ–‡ä»¶è·¯å¾„
   - ä¿ç•™åŸæ–‡æ¡£çš„ç»“æ„ï¼ˆæ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ã€é“¾æ¥ç­‰ï¼‰
   - Markdown æ ¼å¼é€‚åˆ LLM å¤„ç†å’Œäººç±»é˜…è¯»

5. **é”™è¯¯å¤„ç†**:
   - ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ä¼šè¿”å›é”™è¯¯æç¤º
   - å¤§æ–‡ä»¶è½¬æ¢å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´
   - æŸäº›åŠŸèƒ½éœ€è¦é¢å¤–é…ç½®ï¼ˆå¦‚éŸ³é¢‘è½¬å½•éœ€è¦ ffmpegã€Azure æœåŠ¡éœ€è¦ç«¯ç‚¹ï¼‰
   - å¦‚æœçœ‹åˆ° ffmpeg è­¦å‘Šä½†ä¸ä½¿ç”¨éŸ³é¢‘åŠŸèƒ½ï¼Œå¯ä»¥å¿½ç•¥è¯¥è­¦å‘Š

## Workflows

### Step 1: ç¯å¢ƒå‡†å¤‡ï¼ˆå¿…é¡»æ‰§è¡Œï¼‰

åœ¨ä½¿ç”¨ä»»ä½•è„šæœ¬å‰ï¼Œå¿…é¡»å…ˆè¿è¡Œï¼š

```bash
bash setup.sh
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- æ£€æŸ¥å¹¶åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚ä¸å­˜åœ¨ï¼‰
- æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
- å®‰è£… markitdown åŠæ‰€æœ‰ä¾èµ–

### Step 2: ä½¿ç”¨è„šæœ¬è½¬æ¢æ–‡ä»¶

ç¯å¢ƒå‡†å¤‡å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼š

#### è½¬æ¢å•ä¸ªæ–‡ä»¶

```bash
python convert_file.py --input document.pdf --output output.md
```

å‚æ•°è¯´æ˜ï¼š
- `--input`: è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--output`: è¾“å‡º Markdown æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼Œé»˜è®¤è¾“å‡ºåˆ°ç»ˆç«¯ï¼‰
- `--enable-plugins`: å¯ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆå¯é€‰ï¼‰

#### æ‰¹é‡è½¬æ¢æ–‡ä»¶

```bash
python batch_convert.py --input-dir ./documents --output-dir ./markdown --pattern "*.pdf"
```

å‚æ•°è¯´æ˜ï¼š
- `--input-dir`: è¾“å…¥ç›®å½•è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--output-dir`: è¾“å‡ºç›®å½•è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--pattern`: æ–‡ä»¶åŒ¹é…æ¨¡å¼ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸ºæ‰€æœ‰æ–‡ä»¶ï¼‰
- `--recursive`: é€’å½’å¤„ç†å­ç›®å½•ï¼ˆå¯é€‰ï¼‰

#### ä½¿ç”¨ LLM å¢å¼ºè½¬æ¢ï¼ˆéœ€è¦ OpenAI API Keyï¼‰

```bash
python convert_with_llm.py --input image.jpg --output output.md --api-key YOUR_API_KEY
```

å‚æ•°è¯´æ˜ï¼š
- `--input`: è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--output`: è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
- `--api-key`: OpenAI API Keyï¼ˆå¿…éœ€ï¼‰
- `--model`: LLM æ¨¡å‹ï¼ˆå¯é€‰ï¼Œé»˜è®¤ gpt-4oï¼‰

### Step 3: é«˜çº§åŠŸèƒ½

#### ä½¿ç”¨ Azure Document Intelligenceï¼ˆéœ€è¦é…ç½®ï¼‰

```bash
python convert_file.py --input document.pdf --output output.md --azure-endpoint YOUR_ENDPOINT
```

#### ä»å‘½ä»¤è¡Œç®¡é“è¾“å…¥

```bash
cat document.pdf | python convert_file.py > output.md
```

#### éŸ³é¢‘è½¬å½•ï¼ˆéœ€è¦ ffmpegï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨éŸ³é¢‘è½¬å½•åŠŸèƒ½ï¼Œè¯·å…ˆå®‰è£… ffmpegï¼š

```bash
# macOS
brew install ffmpeg

# Ubuntu/Debian
sudo apt-get install ffmpeg
```

ç„¶åè½¬æ¢éŸ³é¢‘æ–‡ä»¶ï¼š

```bash
python convert_file.py --input audio.mp3 --output transcript.md
```

## Initialization

As æ–‡ä»¶è½¬æ¢å·¥å…·, you must follow the above Rules and execute tasks according to Workflows. åœ¨ä½¿ç”¨ä»»ä½•åŠŸèƒ½å‰ï¼Œå¿…é¡»å…ˆè¿è¡Œ setup.sh ç¡®ä¿ç¯å¢ƒæ­£ç¡®é…ç½®ã€‚
